<!-- pages/venue/detail/detail.wxml -->
<view class="container" wx:if="{{!loading}}">
  <!-- åœºé¦†å›¾ç‰‡ -->
  <swiper class="venue-swiper" indicator-dots autoplay circular>
    <swiper-item wx:for="{{venue.images}}" wx:key="*this">
      <image 
        src="{{item}}" 
        mode="aspectFill" 
        bindtap="previewImage"
        data-url="{{item}}"
      ></image>
    </swiper-item>
    <swiper-item wx:if="{{venue.images.length === 0}}">
      <image src="/images/venue-default.png" mode="aspectFill"></image>
    </swiper-item>
  </swiper>

  <!-- åœºé¦†åŸºæœ¬ä¿¡æ¯ -->
  <view class="venue-info card">
    <view class="venue-header">
      <view class="venue-name">{{venue.name}}</view>
      <view class="venue-type tag tag-primary">{{venue.typeIcon}} {{venue.typeText}}</view>
    </view>
    <view class="venue-price">
      <text class="price-value">Â¥{{venue.price}}</text>
      <text class="price-unit">/{{venue.priceUnit || 'å°æ—¶'}}</text>
    </view>
    <view class="venue-meta">
      <view class="meta-item">ğŸ“ {{venue.location}}</view>
      <view class="meta-item">ğŸ• è¥ä¸šæ—¶é—´: {{venue.openTime}} - {{venue.closeTime}}</view>
    </view>
    <view class="venue-desc" wx:if="{{venue.description}}">
      <view class="desc-title">åœºé¦†ä»‹ç»</view>
      <view class="desc-content">{{venue.description}}</view>
    </view>
    <view class="venue-facilities" wx:if="{{venue.facilities && venue.facilities.length > 0}}">
      <view class="facilities-title">è®¾æ–½æœåŠ¡</view>
      <view class="facilities-list">
        <view class="facility-tag" wx:for="{{venue.facilities}}" wx:key="*this">{{item}}</view>
      </view>
    </view>
  </view>

  <!-- æ—¥æœŸé€‰æ‹© -->
  <view class="date-section card">
    <view class="section-title">é€‰æ‹©æ—¥æœŸ</view>
    <scroll-view class="date-list" scroll-x enable-flex>
      <view 
        class="date-item {{selectedDate === item.date ? 'active' : ''}}"
        wx:for="{{dateList}}"
        wx:key="date"
        bindtap="onDateSelect"
        data-date="{{item.date}}"
      >
        <view class="date-day">{{item.day}}</view>
        <view class="date-num">{{item.monthDay}}</view>
      </view>
    </scroll-view>
  </view>

  <!-- æ—¶æ®µé€‰æ‹© -->
  <view class="slot-section card">
    <view class="section-title">é€‰æ‹©æ—¶æ®µ</view>
    
    <view class="loading" wx:if="{{slotsLoading}}">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
    
    <view class="slot-list" wx:elif="{{timeSlots.length > 0}}">
      <view 
        class="slot-item {{item.status}} {{selectedSlot && selectedSlot.startTime === item.startTime ? 'selected' : ''}}"
        wx:for="{{timeSlots}}"
        wx:key="startTime"
        bindtap="onSlotSelect"
        data-slot="{{item}}"
      >
        <view class="slot-time">{{item.startTime}}-{{item.endTime}}</view>
        <view class="slot-status">
          <text wx:if="{{item.status === 'available'}}">å¯é¢„çº¦</text>
          <text wx:elif="{{item.status === 'booked'}}">å·²é¢„çº¦</text>
          <text wx:elif="{{item.status === 'expired'}}">å·²è¿‡æœŸ</text>
        </view>
      </view>
    </view>
    
    <view class="empty-slots" wx:else>
      <text>æš‚æ— å¯é¢„çº¦æ—¶æ®µ</text>
    </view>
  </view>

  <!-- åº•éƒ¨é¢„çº¦æŒ‰é’® -->
  <view class="bottom-bar safe-area-bottom">
    <view class="selected-info" wx:if="{{selectedSlot}}">
      <text>å·²é€‰: {{selectedDate}} {{selectedSlot.startTime}}-{{selectedSlot.endTime}}</text>
    </view>
    <view class="selected-info" wx:else>
      <text class="text-hint">è¯·é€‰æ‹©é¢„çº¦æ—¶æ®µ</text>
    </view>
    <button class="book-btn {{selectedSlot ? '' : 'disabled'}}" bindtap="goToBooking">
      ç«‹å³é¢„çº¦
    </button>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-page" wx:if="{{loading}}">
  <text>åŠ è½½ä¸­...</text>
</view>
