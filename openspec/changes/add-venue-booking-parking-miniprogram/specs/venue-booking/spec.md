# Capability: 场馆预约 (venue-booking)

## ADDED Requirements

### Requirement: 场馆列表展示
系统 SHALL 提供场馆列表页面，展示所有可预约的体育场馆信息。

#### Scenario: 用户浏览场馆列表
- **WHEN** 用户进入场馆列表页面
- **THEN** 系统展示所有启用状态的场馆
- **AND** 每个场馆显示名称、类型、图片、简介
- **AND** 场馆按类型分类展示（篮球场、羽毛球场、游泳池等）

#### Scenario: 场馆列表为空
- **WHEN** 系统中没有可用场馆
- **THEN** 显示"暂无可预约场馆"提示

### Requirement: 场馆详情查看
系统 SHALL 提供场馆详情页面，展示场馆完整信息和可预约时段。

#### Scenario: 查看场馆详情
- **WHEN** 用户点击某个场馆
- **THEN** 进入场馆详情页
- **AND** 展示场馆名称、类型、位置、设施、价格、营业时间
- **AND** 展示场馆图片轮播

#### Scenario: 查看可预约时段
- **WHEN** 用户在场馆详情页选择日期
- **THEN** 系统展示该日期所有时段的预约状态
- **AND** 可预约时段显示为绑色可点击
- **AND** 已被预约时段显示为灰色不可点击

### Requirement: 场馆预约
系统 SHALL 允许已登录用户预约场馆时段。

#### Scenario: 成功预约场馆
- **GIVEN** 用户已登录
- **AND** 选择了可用的场馆时段
- **WHEN** 用户点击"立即预约"按钮
- **THEN** 系统创建预约记录
- **AND** 预约状态设为"待确认"或"已确认"（根据场馆设置）
- **AND** 跳转到预约成功页面

#### Scenario: 未登录用户预约
- **GIVEN** 用户未登录
- **WHEN** 用户尝试预约
- **THEN** 系统提示用户先登录
- **AND** 引导用户进行微信授权登录

#### Scenario: 时段已被预约
- **GIVEN** 用户选择的时段在提交时已被他人预约
- **WHEN** 用户提交预约
- **THEN** 系统提示"该时段已被预约，请选择其他时段"
- **AND** 刷新时段状态

### Requirement: 预约记录管理
系统 SHALL 允许用户查看和管理自己的预约记录。

#### Scenario: 查看我的预约列表
- **WHEN** 用户进入"我的预约"页面
- **THEN** 系统展示用户所有预约记录
- **AND** 按时间倒序排列
- **AND** 每条记录显示场馆名称、预约时段、预约状态

#### Scenario: 查看预约详情
- **WHEN** 用户点击某条预约记录
- **THEN** 展示预约完整信息
- **AND** 显示取消预约按钮（如果可取消）

### Requirement: 取消预约
系统 SHALL 允许用户在规定时间内取消预约。

#### Scenario: 成功取消预约
- **GIVEN** 预约状态为"待确认"或"已确认"
- **AND** 距离预约开始时间大于设定的最小时间（如2小时）
- **WHEN** 用户点击"取消预约"
- **THEN** 系统更新预约状态为"已取消"
- **AND** 释放该时段供其他用户预约

#### Scenario: 超时无法取消
- **GIVEN** 距离预约开始时间小于设定的最小时间
- **WHEN** 用户尝试取消预约
- **THEN** 系统提示"已超过可取消时间，无法取消"

### Requirement: 场馆管理（管理员）
系统 SHALL 允许管理员管理场馆信息。

#### Scenario: 添加新场馆
- **GIVEN** 用户为管理员
- **WHEN** 管理员在管理页面添加场馆
- **AND** 填写场馆名称、类型、位置、设施、价格、营业时间、图片
- **THEN** 系统创建新场馆记录
- **AND** 场馆默认为启用状态

#### Scenario: 编辑场馆信息
- **GIVEN** 用户为管理员
- **WHEN** 管理员编辑场馆信息
- **THEN** 系统更新场馆记录

#### Scenario: 停用/启用场馆
- **GIVEN** 用户为管理员
- **WHEN** 管理员停用某场馆
- **THEN** 该场馆不再出现在用户的场馆列表中
- **AND** 已有预约不受影响

### Requirement: 预约管理（管理员）
系统 SHALL 允许管理员查看和管理所有预约记录。

#### Scenario: 查看所有预约
- **GIVEN** 用户为管理员
- **WHEN** 管理员进入预约管理页面
- **THEN** 系统展示所有预约记录
- **AND** 支持按场馆、日期、状态筛选

#### Scenario: 审核预约（如需审核）
- **GIVEN** 场馆设置为需要审核
- **AND** 存在待确认的预约
- **WHEN** 管理员审核通过
- **THEN** 预约状态更新为"已确认"

#### Scenario: 取消用户预约
- **GIVEN** 用户为管理员
- **WHEN** 管理员取消某条预约
- **THEN** 预约状态更新为"已取消"
- **AND** 释放该时段
